# EXAMPLE (HAP1 vs HAP2) 多线程日志整合：stage speedup / CPU utilization / 时间占比

数据来源：`EXAMPLE/thread_{1,2,4,8,16,32}/fastga.log`（每个目录一个 log，脚本按每个阶段最后一次出现的统计解析）。

## Overall：总 wall time（包含 FAtoGDB + GIXmake + FastGA）

| threads | total wall (s) | total wall (mm:ss) | speedup vs T=1 |
|---:|---:|---:|---:|
| 1 | 154.503 | 2:34.503 | 1.00x |
| 2 | 79.544 | 1:19.544 | 1.94x |
| 4 | 52.627 | 52.627 | 2.94x |
| 8 | 33.656 | 33.656 | 4.59x |
| 16 | 24.984 | 24.984 | 6.18x |
| 32 | 22.180 | 22.180 | 6.97x |

## Per-stage：wall time / CPU% / speedup (vs T=1)

|Stage|T=1 wall(s)|T=1 CPU%|T=1 speedup|T=2 wall(s)|T=2 CPU%|T=2 speedup|T=4 wall(s)|T=4 CPU%|T=4 speedup|T=8 wall(s)|T=8 CPU%|T=8 speedup|T=16 wall(s)|T=16 CPU%|T=16 speedup|T=32 wall(s)|T=32 CPU%|T=32 speedup|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|FAtoGDB(HAP1)|0.456|99.3%|1.00x|0.456|99.5%|1.00x|0.456|99.7%|1.00x|0.454|99.7%|1.00x|0.456|99.7%|1.00x|0.455|99.7%|1.00x|
|GIXmake(HAP1)-partition|1.297|97.2%|1.00x|0.669|191.1%|1.94x|0.442|293.8%|2.93x|0.266|521.7%|4.88x|0.432|407.3%|3.00x|0.920|263.5%|1.41x|
|GIXmake(HAP1)-sort|7.613|97.4%|1.00x|4.245|163.5%|1.79x|2.763|247.8%|2.76x|2.116|340.6%|3.60x|2.086|394.7%|3.65x|2.524|403.0%|3.02x|
|FAtoGDB(HAP2)|0.493|99.3%|1.00x|0.460|99.4%|1.07x|0.460|99.4%|1.07x|0.461|99.4%|1.07x|0.461|99.3%|1.07x|0.463|99.4%|1.06x|
|GIXmake(HAP2)-partition|1.568|97.5%|1.00x|0.741|185.5%|2.12x|0.420|339.1%|3.73x|0.262|529.8%|5.98x|0.353|489.1%|4.44x|0.857|264.0%|1.83x|
|GIXmake(HAP2)-sort|7.671|96.0%|1.00x|4.507|155.6%|1.70x|2.800|244.0%|2.74x|2.188|333.6%|3.51x|2.163|383.5%|3.55x|2.602|390.8%|2.95x|
|FastGA-seed-merge|32.310|95.4%|1.00x|16.915|177.5%|1.91x|11.296|270.4%|2.86x|8.435|370.5%|3.83x|7.486|434.7%|4.32x|5.516|636.0%|5.86x|
|FastGA-align+merge|103.095|99.7%|1.00x|51.551|190.5%|2.00x|33.990|287.0%|3.03x|19.474|500.6%|5.29x|11.547|849.6%|8.93x|8.843|1241.0%|11.66x|

## Breakdown：各 stage 占整个流程的 wall time 比例（%）

|Stage|T=1|T=2|T=4|T=8|T=16|T=32|
|---|---|---|---|---|---|---|
|FAtoGDB(HAP1)|0.3%|0.6%|0.9%|1.3%|1.8%|2.1%|
|GIXmake(HAP1)-partition|0.8%|0.8%|0.8%|0.8%|1.7%|4.1%|
|GIXmake(HAP1)-sort|4.9%|5.3%|5.3%|6.3%|8.3%|11.4%|
|FAtoGDB(HAP2)|0.3%|0.6%|0.9%|1.4%|1.8%|2.1%|
|GIXmake(HAP2)-partition|1.0%|0.9%|0.8%|0.8%|1.4%|3.9%|
|GIXmake(HAP2)-sort|5.0%|5.7%|5.3%|6.5%|8.7%|11.7%|
|FastGA-seed-merge|20.9%|21.3%|21.5%|25.1%|30.0%|24.9%|
|FastGA-align+merge|66.7%|64.8%|64.6%|57.9%|46.2%|39.9%|

## 观察（从这些 log 直接读出来的现象）

- **FastGA-align+merge** 是主耗时阶段，线程数增大时 wall time 下降明显，但加速不是线性。
- **FastGA-seed-merge** 在高线程数时 CPU% 增长很快，但 wall time 也会受到 I/O / 同步影响。
- `GIXmake` 在大线程数（16/32）时分区数变多（log 里能看到 “Partitioning … into 16/32 parts”），但 wall time 不一定继续下降，说明有额外开销/瓶颈。

